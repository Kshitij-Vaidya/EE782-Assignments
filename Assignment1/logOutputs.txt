SAVING TRAIN IMAGES

(3.11.0) (base) kshitijvaidya@Kshitijs-MacBook-Pro-2 data % python prepareFromCSV.py --csv /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/rsicdDataset/train.csv --output ../rsicdDataset --split train
[23:50:38] INFO:DataPrepare: Reading RSICD CSV from /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/rsicdDataset/train.csv ...
[23:50:38] WARNING:DataPrepare: Row 0: Failed to parse image bytes (malformed node or string on line 1: <ast.Name object at 0x101144c10>)
[23:50:59] INFO:DataPrepare: Saved 8734 images : ../rsicdDataset/images/train
[23:50:59] INFO:DataPrepare: Saved Metadata : ../rsicdDataset/trainAnnotations.json

SAVING TEST IMAGES

(3.11.0) (base) kshitijvaidya@Kshitijs-MacBook-Pro-2 data % python prepareFromCSV.py --csv /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/rsicdDataset/test.csv --output ../rsicdDataset --split test 
[23:52:01] INFO:DataPrepare: Reading RSICD CSV from /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/rsicdDataset/test.csv ...
[23:52:01] WARNING:DataPrepare: Row 0: Failed to parse image bytes (malformed node or string on line 1: <ast.Name object at 0x100c68c10>)
[23:52:04] INFO:DataPrepare: Saved 1093 images : ../rsicdDataset/images/test
[23:52:04] INFO:DataPrepare: Saved Metadata : ../rsicdDataset/testAnnotations.json

SAVING VALID IMAGES

(3.11.0) (base) kshitijvaidya@Kshitijs-MacBook-Pro-2 data % python prepareFromCSV.py --csv /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/rsicdDataset/valid.csv --output ../rsicdDataset --split valid 
[23:52:43] INFO:DataPrepare: Reading RSICD CSV from /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/rsicdDataset/valid.csv ...
[23:52:43] WARNING:DataPrepare: Row 0: Failed to parse image bytes (malformed node or string on line 1: <ast.Name object at 0x10496cc10>)
[23:52:46] INFO:DataPrepare: Saved 1094 images : ../rsicdDataset/images/valid
[23:52:46] INFO:DataPrepare: Saved Metadata : ../rsicdDataset/validAnnotations.json

COMBINED LOG OUTPUTS AFTER CODE CHANGES

(.venv) kshitijvaidya@Kshitijs-MacBook-Pro-2 imageCaptioning % python -m data.prepareFromCSV --csv rsicdDataset/train.csv --split train
[12:56:41] INFO:Preprocessing: Reading RSICD CSV from rsicdDataset/train.csv ...
[12:56:41] WARNING:Preprocessing: Row 0: Failed to parse image bytes (malformed node or string on line 1: <ast.Name object at 0x104c0e860>)
[12:57:02] INFO:Preprocessing: Saved 8734 images : ./rsicdDataset/images/train
[12:57:02] INFO:Preprocessing: Saved Metadata : ./rsicdDataset/trainAnnotations.json
(.venv) kshitijvaidya@Kshitijs-MacBook-Pro-2 imageCaptioning % python -m data.prepareFromCSV --csv rsicdDataset/valid.csv --split valid
[12:57:46] INFO:Preprocessing: Reading RSICD CSV from rsicdDataset/valid.csv ...
[12:57:46] WARNING:Preprocessing: Row 0: Failed to parse image bytes (malformed node or string on line 1: <ast.Name object at 0x105426860>)
[12:57:49] INFO:Preprocessing: Saved 1094 images : ./rsicdDataset/images/valid
[12:57:49] INFO:Preprocessing: Saved Metadata : ./rsicdDataset/validAnnotations.json
(.venv) kshitijvaidya@Kshitijs-MacBook-Pro-2 imageCaptioning % python -m data.prepareFromCSV --csv rsicdDataset/test.csv --split test
[12:58:06] INFO:Preprocessing: Reading RSICD CSV from rsicdDataset/test.csv ...
[12:58:06] WARNING:Preprocessing: Row 0: Failed to parse image bytes (malformed node or string on line 1: <ast.Name object at 0x1045b6860>)
[12:58:09] INFO:Preprocessing: Saved 1093 images : ./rsicdDataset/images/test
[12:58:09] INFO:Preprocessing: Saved Metadata : ./rsicdDataset/testAnnotations.json


RUNNING PREPROCESS TO BUILD VOCAB.json

(.venv) kshitijvaidya@Kshitijs-MacBook-Pro-2 Assignment1 % python -m imageCaptioning.data.preprocess
[14:40:18] INFO:Preprocessing: Building Vocabulary from Training Annotations
[14:40:18] INFO:Preprocessing: Built Vocabulary: Size=2701, Minimum Frequency=1, Maximum Size=10000, Unique Tokens=2698
[14:40:18] INFO:Preprocessing: Saved vocabulary to ./imageCaptioning/outputs/vocab.json (Size = 2701)
[14:40:18] INFO:Preprocessing: Computing training and validation statistics
[14:40:18] INFO:Preprocessing: [train] Vocabulary Coverage : 100.00
[14:40:19] INFO:Preprocessing: [valid] Vocabulary Coverage : 99.04
[14:40:19] INFO:Preprocessing: Saved token statistics CSV



TRANSFORMER MODEL EVALUATION ON TEST DATA 

(.venv) kshitijvaidya@Kshitijs-MacBook-Pro-2 Assignment1 % python -m imageCaptioning.evaluation.decoding --model-type transformer
[20:47:47] INFO:Decoding Test: Loaded Vocaulary from path /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/outputs/vocab.json
[20:47:47] INFO:Encoder: Initialized CNN Encoder with resnet18,Finetune = False, Output Dimensions = 512
[20:47:47] INFO:Transformer Decoder: Initialised Transformer Decoder with Vocab = 2701, d_model = 512, Layers = 4, Heads = 4
[20:47:47] INFO:Captioner: Initialized Captioner with Encoder = resnet18 and Decoder = transformer
[20:48:29] INFO:Decoding Test: Decoded Captions (Token Indices)
[20:48:29] INFO:Decoding Test: Saved decoded token indices to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/outputs/transformerDecodedTest.json
(.venv) kshitijvaidya@Kshitijs-MacBook-Pro-2 Assignment1 % python -m imageCaptioning.evaluation.getCaptions --model-type transformer
[20:48:53] INFO:Caption Decoding: Loaded Vocabulary from /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/outputs/vocab.json
[20:48:53] INFO:Caption Decoding: Saved the decoded captions to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/outputs/transformerDecodedTestCaptions.json
(.venv) kshitijvaidya@Kshitijs-MacBook-Pro-2 Assignment1 % python -m imageCaptioning.evaluation.metrics --model-type transformer    
[20:49:06] INFO:Metrics: No Missing Files. Can evaluate BLEU4 and METEOR metrics
[20:49:09] INFO:Metrics: BLEU-4 : 0.1440
[20:49:09] INFO:Metrics: METEOR : 0.3443


LSTM MODEL EVALUATION ON TEST DATA

(.venv) kshitijvaidya@Kshitijs-MacBook-Pro-2 Assignment1 % python -m imageCaptioning.evaluation.decoding --model-type lstm
[23:14:29] INFO:Decoding Test: Loaded Vocaulary from path /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/outputs/vocab.json
[23:14:30] INFO:Encoder: Initialized CNN Encoder with resnet18,Finetune = False, Output Dimensions = 512
[23:14:30] INFO:LSTM Decoder: Initialised LSTM Decoder with Vocabulary=2701, Embedding Dimension = 256, Hidden Dimensions = 512, Layers = 2
[23:14:30] INFO:Captioner: Initialized Captioner with Encoder = resnet18 and Decoder = lstm
[23:14:58] INFO:Decoding Test: Decoded Captions (Token Indices)
[23:14:58] INFO:Decoding Test: Saved decoded token indices to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/outputs/lstmDecodedTest.json
(.venv) kshitijvaidya@Kshitijs-MacBook-Pro-2 Assignment1 % python -m imageCaptioning.evaluation.getCaptions --model-type lstm
[23:15:08] INFO:Caption Decoding: Loaded Vocabulary from /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/outputs/vocab.json
[23:15:08] INFO:Caption Decoding: Saved the decoded captions to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/outputs/lstmDecodedTestCaptions.json
(.venv) kshitijvaidya@Kshitijs-MacBook-Pro-2 Assignment1 % python -m imageCaptioning.evaluation.metrics --model-type lstm    
[23:15:18] INFO:Metrics: No Missing Files. Can evaluate BLEU4 and METEOR metrics
[23:15:20] INFO:Metrics: BLEU-4 : 0.1591
[23:15:20] INFO:Metrics: METEOR : 0.3661



LSTM RESNET18 TRAINING 20 EPOCHS

(.venv) kshitijvaidya@Kshitijs-MacBook-Pro-2 Assignment1 % python -m imageCaptioning.main --model-type lstm --epochs 20
[20:56:51] INFO:Main: Starting Image Captioning Training on RSICD Dataset
[20:56:51] INFO:Main: Device: cpu
[20:56:51] INFO:Main: Model Type: lstm
[20:56:51] INFO:Main: Encoder: resnet18
[20:56:51] INFO:Main: Fine-tune Encoder: False
[20:56:51] INFO:Main: Batch Size: 32
[20:56:51] INFO:Main: Epochs: 20
[20:56:51] INFO:Main: Loading vocabulary from /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/outputs/vocab.json
[20:56:51] INFO:Main: Loaded vocabulary with 2701 tokens
[20:56:51] INFO:Main: Training dataset size: 8734
[20:56:51] INFO:Main: Validation dataset size: 1094
[20:56:51] INFO:Encoder: Initialized CNN Encoder with resnet18,Finetune = False, Output Dimensions = 512
[20:56:51] INFO:LSTM Decoder: Initialised LSTM Decoder with Vocabulary=2701, Embedding Dimension = 256, Hidden Dimensions = 512, Layers = 2
[20:56:51] INFO:Captioner: Initialized Captioner with Encoder = resnet18 and Decoder = lstm
[20:56:51] INFO:Main: Total parameters: 17,719,757
[20:56:51] INFO:Main: Trainable parameters: 6,543,245
[20:56:51] INFO:Main: Starting training...
[20:56:51] INFO:Loss Function: Initialised CrossEntropyLoss with ignore_index = 0
[20:56:51] INFO:Optimizer: Building Adam Optimizer (CNN LR = 0.0001, Decoder LR = 0.0002, Transformer LR = 2e-05)
[20:56:51] INFO:Optimizer: Using StepLR Scheduler: Step Size = 5, Gamma = 0.5
Epoch 1 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [03:59<00:00,  1.14it/s]
Epoch 1 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:48<00:00,  1.40s/it]
[21:01:40] INFO:Train: Epoch 1: Train Loss = 4.3869, Validation Loss = 3.9385
[21:01:40] INFO:Train: Validation Loss improved from inf to 3.9385
[21:01:40] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 2 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:00<00:00,  1.14it/s]
Epoch 2 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:48<00:00,  1.40s/it]
[21:06:29] INFO:Train: Epoch 2: Train Loss = 3.0779, Validation Loss = 3.3802
[21:06:29] INFO:Train: Validation Loss improved from 3.9385 to 3.3802
[21:06:29] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 3 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:00<00:00,  1.13it/s]
Epoch 3 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.40s/it]
[21:11:19] INFO:Train: Epoch 3: Train Loss = 2.6210, Validation Loss = 3.1610
[21:11:19] INFO:Train: Validation Loss improved from 3.3802 to 3.1610
[21:11:19] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 4 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:04<00:00,  1.12it/s]
Epoch 4 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.41s/it]
[21:16:14] INFO:Train: Epoch 4: Train Loss = 2.3689, Validation Loss = 3.0087
[21:16:14] INFO:Train: Validation Loss improved from 3.1610 to 3.0087
[21:16:14] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 5 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:14<00:00,  1.07it/s]
Epoch 5 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.42s/it]
[21:21:19] INFO:Train: Epoch 5: Train Loss = 2.1812, Validation Loss = 2.9366
[21:21:19] INFO:Train: Validation Loss improved from 3.0087 to 2.9366
[21:21:19] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 6 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:04<00:00,  1.12it/s]
Epoch 6 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.41s/it]
[21:26:13] INFO:Train: Epoch 6: Train Loss = 2.0392, Validation Loss = 2.9102
[21:26:13] INFO:Train: Validation Loss improved from 2.9366 to 2.9102
[21:26:13] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 7 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:04<00:00,  1.11it/s]
Epoch 7 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.41s/it]
[21:31:07] INFO:Train: Epoch 7: Train Loss = 1.9635, Validation Loss = 2.8571
[21:31:07] INFO:Train: Validation Loss improved from 2.9102 to 2.8571
[21:31:07] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 8 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:04<00:00,  1.12it/s]
Epoch 8 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.41s/it]
[21:36:01] INFO:Train: Epoch 8: Train Loss = 1.8986, Validation Loss = 2.8344
[21:36:01] INFO:Train: Validation Loss improved from 2.8571 to 2.8344
[21:36:01] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 9 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:04<00:00,  1.12it/s]
Epoch 9 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.41s/it]
[21:40:55] INFO:Train: Epoch 9: Train Loss = 1.8369, Validation Loss = 2.8258
[21:40:55] INFO:Train: Validation Loss improved from 2.8344 to 2.8258
[21:40:55] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 10 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:06<00:00,  1.11it/s]
Epoch 10 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.42s/it]
[21:45:52] INFO:Train: Epoch 10: Train Loss = 1.7767, Validation Loss = 2.8173
[21:45:52] INFO:Train: Validation Loss improved from 2.8258 to 2.8173
[21:45:52] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 11 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:05<00:00,  1.11it/s]
Epoch 11 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.41s/it]
[21:50:46] INFO:Train: Epoch 11: Train Loss = 1.7221, Validation Loss = 2.7938
[21:50:46] INFO:Train: Validation Loss improved from 2.8173 to 2.7938
[21:50:46] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 12 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:06<00:00,  1.11it/s]
Epoch 12 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.41s/it]
[21:55:42] INFO:Train: Epoch 12: Train Loss = 1.6926, Validation Loss = 2.7910
[21:55:42] INFO:Train: Validation Loss improved from 2.7938 to 2.7910
[21:55:42] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 13 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:08<00:00,  1.10it/s]
Epoch 13 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.41s/it]
[22:00:40] INFO:Train: Epoch 13: Train Loss = 1.6669, Validation Loss = 2.7981
Epoch 14 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:05<00:00,  1.11it/s]
Epoch 14 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.41s/it]
[22:05:35] INFO:Train: Epoch 14: Train Loss = 1.6434, Validation Loss = 2.7945
Epoch 15 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:06<00:00,  1.11it/s]
Epoch 15 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.41s/it]
[22:10:30] INFO:Train: Epoch 15: Train Loss = 1.6213, Validation Loss = 2.8058
Epoch 16 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:05<00:00,  1.11it/s]
Epoch 16 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.41s/it]
[22:15:25] INFO:Train: Epoch 16: Train Loss = 1.5933, Validation Loss = 2.7853
[22:15:25] INFO:Train: Validation Loss improved from 2.7910 to 2.7853
[22:15:25] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 17 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:05<00:00,  1.11it/s]
Epoch 17 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.42s/it]
[22:20:21] INFO:Train: Epoch 17: Train Loss = 1.5810, Validation Loss = 2.7803
[22:20:21] INFO:Train: Validation Loss improved from 2.7853 to 2.7803
[22:20:21] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt
Epoch 18 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:05<00:00,  1.11it/s]
Epoch 18 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.41s/it]
[22:25:15] INFO:Train: Epoch 18: Train Loss = 1.5700, Validation Loss = 2.7958
Epoch 19 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:06<00:00,  1.11it/s]
Epoch 19 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.42s/it]
[22:30:12] INFO:Train: Epoch 19: Train Loss = 1.5577, Validation Loss = 2.7884
Epoch 20 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:11<00:00,  1.09it/s]
Epoch 20 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:49<00:00,  1.43s/it]
[22:35:13] INFO:Train: Epoch 20: Train Loss = 1.5470, Validation Loss = 2.7888
[22:35:13] INFO:Main: Training completed!
[22:35:13] INFO:Main: Best model saved to: /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_resnet18.pt


TRANSFORMER MODEL EVALUATION 20 EPOCHS

(.venv) kshitijvaidya@Kshitijs-MacBook-Pro-2 Assignment1 % python -m imageCaptioning.main --model-type transformer --epochs 20 
[16:53:27] INFO:Main: Starting Image Captioning Training on RSICD Dataset
[16:53:27] INFO:Main: Device: cpu
[16:53:27] INFO:Main: Model Type: transformer
[16:53:27] INFO:Main: Encoder: resnet18
[16:53:27] INFO:Main: Fine-tune Encoder: False
[16:53:27] INFO:Main: Batch Size: 32
[16:53:27] INFO:Main: Epochs: 20
[16:53:27] INFO:Main: Loading vocabulary from ./imageCaptioning/outputs/vocab.json
[16:53:27] INFO:Preprocessing: Built Vocabulary: Size=3, Minimum Frequency=1, Maximum Size=10000, Unique Tokens=0
[16:53:27] INFO:Main: Loaded vocabulary with 2701 tokens
[16:53:27] INFO:Main: Training dataset size: 8734
[16:53:27] INFO:Main: Validation dataset size: 1094
[16:53:27] INFO:Encoder: Initialized CNN Encoder with resnet18,Finetune = False, Output Dimensions = 512
[16:53:27] INFO:Transformer Decoder: Initialised Transformer Decoder with Vocab = 2701, d_model = 512, Layers = 4, Heads = 4
[16:53:27] INFO:Captioner: Initialized Captioner with Encoder = resnet18 and Decoder = transformer
[16:53:27] INFO:Main: Total parameters: 31,302,861
[16:53:27] INFO:Main: Trainable parameters: 20,126,349
[16:53:27] INFO:Main: Starting training...
[16:53:27] INFO:Loss Function: Initialised CrossEntropyLoss with ignore_index = 0
[16:53:27] INFO:Optimizer: Building Adam Optimizer (CNN LR = 0.0001, Decoder LR = 0.0002, Transformer LR = 2e-05)
[16:53:27] INFO:Optimizer: Using StepLR Scheduler: Step Size = 5, Gamma = 0.5
Epoch 1 [Train]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:45<00:00,  1.05s/it]
Epoch 1 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.46s/it]
[16:59:04] INFO:Train: Epoch 1: Train Loss = 2.7662, Validation Loss = 2.9141
[16:59:04] INFO:Train: Validation Loss improved from inf to 2.9141
[16:59:04] INFO:Utilities: Saving checkpoint to ./imageCaptioning/checkpoints/./imageCaptioning/checkpoints/model_transformer_resnet18.pt
Epoch 2 [Train]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:44<00:00,  1.04s/it]
Epoch 2 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.45s/it]
[17:04:40] INFO:Train: Epoch 2: Train Loss = 1.8696, Validation Loss = 2.7621
[17:04:40] INFO:Train: Validation Loss improved from 2.9141 to 2.7621
[17:04:40] INFO:Utilities: Saving checkpoint to ./imageCaptioning/checkpoints/./imageCaptioning/checkpoints/model_transformer_resnet18.pt
Epoch 3 [Train]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:44<00:00,  1.04s/it]
Epoch 3 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:51<00:00,  1.47s/it]
[17:10:16] INFO:Train: Epoch 3: Train Loss = 1.6184, Validation Loss = 2.7233
[17:10:16] INFO:Train: Validation Loss improved from 2.7621 to 2.7233
[17:10:16] INFO:Utilities: Saving checkpoint to ./imageCaptioning/checkpoints/./imageCaptioning/checkpoints/model_transformer_resnet18.pt
Epoch 4 [Train]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:50<00:00,  1.06s/it]
Epoch 4 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:52<00:00,  1.51s/it]
[17:15:59] INFO:Train: Epoch 4: Train Loss = 1.4531, Validation Loss = 2.7508
Epoch 5 [Train]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:46<00:00,  1.05s/it]
Epoch 5 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.44s/it]
[17:21:36] INFO:Train: Epoch 5: Train Loss = 1.3111, Validation Loss = 2.7641
Epoch 6 [Train]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:46<00:00,  1.05s/it]
Epoch 6 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.45s/it]
[17:27:12] INFO:Train: Epoch 6: Train Loss = 1.1036, Validation Loss = 2.8236
Epoch 7 [Train]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:47<00:00,  1.05s/it]
Epoch 7 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.44s/it]
[17:32:50] INFO:Train: Epoch 7: Train Loss = 1.0169, Validation Loss = 2.8483
Epoch 8 [Train]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:46<00:00,  1.05s/it]
Epoch 8 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.45s/it]
[17:38:27] INFO:Train: Epoch 8: Train Loss = 0.9477, Validation Loss = 2.8760
Epoch 9 [Train]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:44<00:00,  1.04s/it]
Epoch 9 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.45s/it]
[17:44:02] INFO:Train: Epoch 9: Train Loss = 0.8860, Validation Loss = 2.9239
Epoch 10 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:47<00:00,  1.05s/it]
Epoch 10 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.45s/it]
[17:49:41] INFO:Train: Epoch 10: Train Loss = 0.8290, Validation Loss = 2.9910
Epoch 11 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:46<00:00,  1.05s/it]
Epoch 11 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.45s/it]
[17:55:19] INFO:Train: Epoch 11: Train Loss = 0.7235, Validation Loss = 3.0042
Epoch 12 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:39<00:00,  1.02s/it]
Epoch 12 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.45s/it]
[18:00:49] INFO:Train: Epoch 12: Train Loss = 0.6841, Validation Loss = 3.0205
Epoch 13 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:37<00:00,  1.02s/it]
Epoch 13 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.43s/it]
[18:06:17] INFO:Train: Epoch 13: Train Loss = 0.6554, Validation Loss = 3.0945
Epoch 14 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:41<00:00,  1.03s/it]
Epoch 14 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.43s/it]
[18:11:48] INFO:Train: Epoch 14: Train Loss = 0.6293, Validation Loss = 3.1097
Epoch 15 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:42<00:00,  1.03s/it]
Epoch 15 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.43s/it]
[18:17:21] INFO:Train: Epoch 15: Train Loss = 0.6038, Validation Loss = 3.1419
Epoch 16 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:37<00:00,  1.02s/it]
Epoch 16 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.43s/it]
[18:22:48] INFO:Train: Epoch 16: Train Loss = 0.5555, Validation Loss = 3.1509
Epoch 17 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:39<00:00,  1.02s/it]
Epoch 17 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.43s/it]
[18:28:18] INFO:Train: Epoch 17: Train Loss = 0.5375, Validation Loss = 3.1890
Epoch 18 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:47<00:00,  1.05s/it]
Epoch 18 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:51<00:00,  1.47s/it]
[18:33:57] INFO:Train: Epoch 18: Train Loss = 0.5278, Validation Loss = 3.1913
Epoch 19 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:47<00:00,  1.05s/it]
Epoch 19 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.44s/it]
[18:39:34] INFO:Train: Epoch 19: Train Loss = 0.5152, Validation Loss = 3.2211
Epoch 20 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [04:47<00:00,  1.05s/it]
Epoch 20 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:50<00:00,  1.45s/it]
[18:45:12] INFO:Train: Epoch 20: Train Loss = 0.5039, Validation Loss = 3.2313
[18:45:12] INFO:Main: Training completed!
[18:45:12] INFO:Main: Best model saved to: ./imageCaptioning/checkpoints/model_transformer_resnet18.pt



MOBILENET LSTM MODEL TRAINING (PARTIAL >10 EPOCHS)

(.venv) kshitijvaidya@Kshitijs-MacBook-Pro-2 Assignment1 % python -m imageCaptioning.main --model-type lstm --epochs 20 --finetune --encoder-name mobilenet
[11:40:15] INFO:Main: Starting Image Captioning Training on RSICD Dataset
[11:40:15] INFO:Main: Device: cpu
[11:40:15] INFO:Main: Model Type: lstm
[11:40:15] INFO:Main: Encoder: mobilenet
[11:40:15] INFO:Main: Fine-tune Encoder: True
[11:40:15] INFO:Main: Batch Size: 32
[11:40:15] INFO:Main: Epochs: 20
[11:40:15] INFO:Main: Loading vocabulary from /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/outputs/vocab.json
[11:40:15] INFO:Main: Loaded vocabulary with 2701 tokens
[11:40:15] INFO:Main: Training dataset size: 8734
[11:40:15] INFO:Main: Validation dataset size: 1094
Downloading: "https://download.pytorch.org/models/mobilenet_v2-b0353104.pth" to /Users/kshitijvaidya/.cache/torch/hub/checkpoints/mobilenet_v2-b0353104.pth
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13.6M/13.6M [00:04<00:00, 3.29MB/s]
[11:40:26] INFO:Encoder: Initialized CNN Encoder with mobilenet,Finetune = True, Output Dimensions = 512
[11:40:26] INFO:LSTM Decoder: Initialised LSTM Decoder with Vocabulary=2701, Embedding Dimension = 256, Hidden Dimensions = 512, Layers = 2
[11:40:26] INFO:Captioner: Initialized Captioner with Encoder = mobilenet and Decoder = lstm
[11:40:26] INFO:Main: Total parameters: 9,160,333
[11:40:26] INFO:Main: Trainable parameters: 9,160,333
[11:40:26] INFO:Main: Starting training...
[11:40:26] INFO:Loss Function: Initialised CrossEntropyLoss with ignore_index = 0
[11:40:26] INFO:Optimizer: Building Adam Optimizer (CNN LR = 0.0001, Decoder LR = 0.0002, Transformer LR = 2e-05)
[11:40:26] INFO:Optimizer: Using StepLR Scheduler: Step Size = 5, Gamma = 0.5
Epoch 1 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [31:30<00:00,  6.93s/it]
Epoch 1 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:02<00:00,  1.77s/it]
[12:12:58] INFO:Train: Epoch 1: Train Loss = 4.4231, Validation Loss = 3.9671
[12:12:58] INFO:Train: Validation Loss improved from inf to 3.9671
[12:12:58] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_mobilenet.pt
Epoch 2 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [32:53<00:00,  7.23s/it]
Epoch 2 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:04<00:00,  1.84s/it]
[12:46:56] INFO:Train: Epoch 2: Train Loss = 3.1058, Validation Loss = 3.3532
[12:46:56] INFO:Train: Validation Loss improved from 3.9671 to 3.3532
[12:46:56] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_mobilenet.pt
Epoch 3 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [33:17<00:00,  7.32s/it]
Epoch 3 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:01<00:00,  1.77s/it]
[13:21:15] INFO:Train: Epoch 3: Train Loss = 2.5880, Validation Loss = 3.0984
[13:21:15] INFO:Train: Validation Loss improved from 3.3532 to 3.0984
[13:21:15] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_mobilenet.pt
Epoch 4 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [32:39<00:00,  7.18s/it]
Epoch 4 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:01<00:00,  1.75s/it]
[13:54:56] INFO:Train: Epoch 4: Train Loss = 2.2957, Validation Loss = 2.9405
[13:54:56] INFO:Train: Validation Loss improved from 3.0984 to 2.9405
[13:54:56] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_mobilenet.pt
Epoch 5 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [32:28<00:00,  7.14s/it]
Epoch 5 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:01<00:00,  1.76s/it]
[14:28:27] INFO:Train: Epoch 5: Train Loss = 2.0945, Validation Loss = 2.8364
[14:28:27] INFO:Train: Validation Loss improved from 2.9405 to 2.8364
[14:28:27] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_mobilenet.pt
Epoch 6 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [33:33<00:00,  7.37s/it]
Epoch 6 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:01<00:00,  1.76s/it]
[15:03:02] INFO:Train: Epoch 6: Train Loss = 1.9365, Validation Loss = 2.8041
[15:03:02] INFO:Train: Validation Loss improved from 2.8364 to 2.8041
[15:03:02] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_mobilenet.pt
Epoch 7 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [34:32<00:00,  7.59s/it]
Epoch 7 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:01<00:00,  1.77s/it]
[15:38:36] INFO:Train: Epoch 7: Train Loss = 1.8509, Validation Loss = 2.7734
[15:38:36] INFO:Train: Validation Loss improved from 2.8041 to 2.7734
[15:38:36] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_mobilenet.pt
Epoch 8 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [33:47<00:00,  7.43s/it]
Epoch 8 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:01<00:00,  1.76s/it]
[16:13:26] INFO:Train: Epoch 8: Train Loss = 1.7799, Validation Loss = 2.7677
[16:13:26] INFO:Train: Validation Loss improved from 2.7734 to 2.7677
[16:13:26] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_mobilenet.pt
Epoch 9 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [32:25<00:00,  7.13s/it]
Epoch 9 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:01<00:00,  1.74s/it]
[16:46:52] INFO:Train: Epoch 9: Train Loss = 1.7103, Validation Loss = 2.7643
[16:46:52] INFO:Train: Validation Loss improved from 2.7677 to 2.7643
[16:46:52] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_mobilenet.pt
Epoch 10 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [33:09<00:00,  7.29s/it]
Epoch 10 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:01<00:00,  1.77s/it]
[17:21:03] INFO:Train: Epoch 10: Train Loss = 1.6467, Validation Loss = 2.7433
[17:21:03] INFO:Train: Validation Loss improved from 2.7643 to 2.7433
[17:21:03] INFO:Utilities: Saving checkpoint to /Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/checkpoints/model_lstm_mobilenet.pt
Epoch 11 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [33:26<00:00,  7.35s/it]
Epoch 11 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:02<00:00,  1.80s/it]
[17:55:32] INFO:Train: Epoch 11: Train Loss = 1.5815, Validation Loss = 2.7486
Epoch 12 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 273/273 [34:04<00:00,  7.49s/it]
Epoch 12 [Valid]: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [01:01<00:00,  1.76s/it]
[18:30:39] INFO:Train: Epoch 12: Train Loss = 1.5454, Validation Loss = 2.7654
Epoch 13 [Train]:  45%|██████████████████████████████████████████████████████▌                                                                  | 123/273 [14:31<17:45,  7.10s/it]^C^CException ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x102bf3ec0>
Traceback (most recent call last):
  File "/Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1663, in __del__
    def __del__(self):

  File "/Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/.venv/lib/python3.11/site-packages/torch/utils/data/_utils/signal_handling.py", line 73, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 53259) is killed by signal: Interrupt: 2. 
Epoch 13 [Train]:  45%|██████████████████████████████████████████████████████▌                                                                  | 123/273 [14:38<17:51,  7.14s/it]
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/main.py", line 154, in <module>
    
  File "/Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/main.py", line 138, in main
    LOGGER.info("Starting training...")
  File "/Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/training/train.py", line 84, in trainModel
    startTime = time.time()
                       ^^^^^
  File "/Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/imageCaptioning/training/train.py", line 35, in trainEpoch
    optimizer.zero_grad()
    ^^^^^^^^^^^^^^^
  File "/Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/.venv/lib/python3.11/site-packages/torch/_tensor.py", line 647, in backward
    torch.autograd.backward(
  File "/Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/.venv/lib/python3.11/site-packages/torch/autograd/__init__.py", line 354, in backward
    _engine_run_backward(
  File "/Users/kshitijvaidya/EE782-AdvancedTopicsInML/Assignment1/.venv/lib/python3.11/site-packages/torch/autograd/graph.py", line 829, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt


